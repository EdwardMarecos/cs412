<!-- 
inherits from base.html. This template will 
render a profile page for one user (i.e., a 
single Profile record).
Display a larger-format image, and display all 
the data attributes stored in the Profile record. 
formatting was that of which i found aesthetically
pleasing.
-->

<!-- templates/mini_fb/show_profile.html -->

{% extends 'mini_fb/base.html' %}

{% block content %}
<div class="container" style="display: flex; flex-wrap: wrap; gap: 20px; align-items: center;">
    <!-- Profile Image -->
    <div style="flex: 1 1 150px; max-width: 300px;">
        <img src="{{ profile.get_profile_image }}" alt="Profile Image"
            style="width: 100%; height: auto; border-radius: 15px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
    </div>
    
    <!-- Profile Information -->
    <div style="flex: 2; max-width: 600px;">
        <h2 style="color: #4A90E2;">{{ profile.first_name }} {{ profile.last_name }}</h2>
        <p><strong>Birthdate:</strong> {{ profile.birth_date }}</p>
        <p><strong>City:</strong> {{ profile.city }}</p>
        <p><strong>Email:</strong> {{ profile.email_address }}</p>
        
        {% if request.user == profile.user %}
            <!-- Link to create a new status message -->
            <a href="{% url 'create_status' %}" style="
                display: inline-block;
                margin-top: 20px;
                padding: 10px 15px;
                background-color: #42A5F5;
                color: white;
                text-decoration: none;
                border-radius: 5px;
                transition: background-color 0.3s ease;
            " onmouseover="this.style.backgroundColor='#1E88E5';"
            onmouseout="this.style.backgroundColor='#42A5F5';">Post a Status Message</a>

            <!-- Link to Update Profile -->
            <a href="{% url 'update_profile' %}" style="
            display: inline-block;
            margin-top: 10px;
            padding: 10px 15px;
            background-color: #FFC107;
            color: black;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s ease;" 
            onmouseover="this.style.backgroundColor='#FFB300';" 
            onmouseout="this.style.backgroundColor='#FFC107';">
            Update Profile</a>
        {% endif %}
    </div>


    <!-- Penguin GIF Image -->
    <div style="flex: 1 1 150px; max-width: 300px; align-self: center;">
        <img src="https://i.gifer.com/origin/39/39f78ed05b58bd9fa3962034d7907c07_w200.gif" alt="Penguin GIF" style="width: 100%; height: auto; border-radius: 15px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
    </div>
</div>


    <!-- Existing Status Messages Section -->
    <div class="container" style="margin-top: 30px;">
        <h3 style="color: #1976D2;">Status Messages</h3>

        {% for message in profile.get_status_messages %}
        <div style="
            margin-bottom: 15px; 
            padding: 10px; 
            background-color: #f9f9f9; 
            border-radius: 10px; 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);">

            <!-- Images Section -->
            <div style="
                display: flex; 
                flex-wrap: wrap;  
                gap: 10px; 
                margin-left: 20px; 
                max-width: 100%; 
                justify-content: flex-start;">
                {% for img in message.get_images %}
                <div style="
                    display: flex; 
                    align-items: center; 
                    justify-content: center;
                    overflow: visible;
                    transition: all 0.3s ease-in-out;">
                    <div>
                        <img src="{{ img.image.url }}" alt="Status Image" 
                            style="
                                width: 100px;
                                height: 100px;
                                border-radius: 15px;
                                object-fit: cover;
                                transition: all 0.3s ease-in-out;"
                            onmouseover="
                                const ratio = this.naturalHeight / this.naturalWidth;
                                let newWidth = 160;
                                let newHeight = 160 * ratio;

                                if (newHeight < 100) {
                                    newHeight = 100;
                                    newWidth = 100 / ratio;
                                }
                                if (newWidth < 100) {
                                    newWidth = 100;
                                    newHeight = 100 * ratio;
                                }

                                this.style.width = newWidth + 'px'; 
                                this.style.height = newHeight + 'px';"
                            onmouseout="
                                this.style.width = '100px'; 
                                this.style.height = '100px';">
                        <p style="text-align: center; font-size: 0.9em;">
                            <small>{{ img.timestamp|date:"F d, Y H:i" }}</small>
                        </p>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- Status Message Text -->
            <div style="flex: 1; margin-left: 20px; padding-bottom: 20px;">
                <p style="color:#1976D2;">
                    "{{ message.message }}"
                </p>
            </div>

            <!-- Timestamp and Action Buttons -->
            <div style="
                display: flex;
                justify-content: start;
                align-items: center;
                margin-top: 10px;
                padding: 5px 0;">
                <strong>Shared on {{ message.timestamp|date:"F d, Y h:i A" }}</strong>
                <div style="display: flex; gap: 10px; margin-left: 20px;">
                    {% if request.user == profile.user %}
                    <div style="display: flex; gap: 10px; margin-left: 20px;">
                        <a href="{% url 'update_status' message.pk %}" style="
                            background-color: #42A5F5; 
                            color: white; 
                            padding: 5px 10px; 
                            border-radius: 5px; 
                            text-decoration: none; 
                            font-size: 14px;">
                            Edit
                        </a>
                        <a href="{% url 'remove_status' message.pk %}" style="
                            background-color: #D32F2F; 
                            color: white; 
                            padding: 5px 10px; 
                            border-radius: 5px; 
                            text-decoration: none; 
                            font-size: 14px;">
                            Delete
                        </a>
                    </div>
                {% endif %}
                </div>
            </div>
        </div>
        {% empty %}
        <p>No status messages yet. Time to post one!</p>
        {% endfor %}
    </div>


    <!-- Show Friends Section -->
    <div class="container" style="margin-top: 30px;">
        <h3 style="color: #1976D2;">Friends</h3>

        {% if profile.get_friends %}
            <div style="display: flex; flex-wrap: wrap; gap: 15px;">
                {% for friend in profile.get_friends %}
                    <div style="
                        width: 100px; 
                        text-align: center; 
                        background-color: #f9f9f9;
                        padding: 10px; 
                        border-radius: 10px; 
                        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                    ">
                        <!-- Friend's Profile Picture -->
                        <a href="{% url 'show_profile' friend.pk %}">
                            <img src="{{ friend.get_profile_image }}" 
                                alt="{{ friend.first_name }} {{ friend.last_name }}" 
                                style="
                                    width: 80px; 
                                    height: 80px; 
                                    border-radius: 15px; 
                                    object-fit: cover; 
                                    margin-bottom: 5px;
                                ">
                        </a>
                        <!-- Friend's Name -->
                        <a href="{% url 'show_profile' friend.pk %}" style="
                            display: block;
                            text-decoration: none;
                            color: #4A90E2;
                            font-weight: bold;
                            font-size: 14px;
                            margin-top: 5px;
                        ">
                            {{ friend.first_name }} {{ friend.last_name }}
                        </a>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>This user has no friends yet.</p>
        {% endif %}

        <!-- Link to show friend suggestions for Profile -->
        {% if request.user == profile.user %}
            <a href="{% url 'friend_suggestions' %}" style="
            display: inline-block;
            margin-top: 10px;
            padding: 10px 15px;
            background-color: #42A5F5;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s ease;" 
            onmouseover="this.style.backgroundColor='#1E88E5';" 
            onmouseout="this.style.backgroundColor='#42A5F5';">
            Show Friend Suggestions</a>
        {% endif %}
        </div>    

{% endblock %}
